<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ArthSaar — Personal Finance Tracker (Frontend)</title>
    <style>
        :root {
            --bg: #0f1724;
            --card: #0b1220;
            --muted: #9aa4b2;
            --accent: #6ee7b7;
            --danger: #ff7b7b;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-2: rgba(255, 255, 255, 0.02);
            font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        }

        * {
            box-sizing: border-box
        }

        html,
        body {
            height: 100%;
            margin: 0;
            background: linear-gradient(180deg, #071021 0%, #081226 100%);
            color: #e6eef6
        }

        .app {
            display: flex;
            min-height: 100vh
        }
        .sidebar {
            width: 260px;
            padding: 24px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
            border-right: 1px solid rgba(255, 255, 255, 0.03)
        }

        .brand {
            font-weight: 700;
            font-size: 20px;
            letter-spacing: 0.6px;
            margin-bottom: 18px
        }

        .nav {
            display: flex;
            flex-direction: column;
            gap: 8px
        }

        .nav button {
            background: none;
            border: none;
            color: var(--muted);
            padding: 10px 12px;
            text-align: left;
            border-radius: 8px;
            cursor: pointer
        }

        .nav button.active {
            background: var(--glass);
            color: var(--accent)
        }

        .main {
            flex: 1;
            padding: 28px
        }

        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px
        }

        .search {
            background: var(--glass);
            padding: 8px 10px;
            border-radius: 8px;
            color: var(--muted);
            border: 1px solid rgba(255, 255, 255, 0.02)
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 18px
        }

        .card {
            background: var(--card);
            padding: 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.03)
        }

        .muted {
            color: var(--muted);
            font-size: 13px
        }

        .big {
            font-size: 22px;
            font-weight: 700
        }
        .table {
            width: 100%;
            border-collapse: collapse
        }

        .table th,
        .table td {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.02);
            text-align: left
        }

        .btn {
            padding: 8px 10px;
            border-radius: 8px;
            border: none;
            cursor: pointer
        }

        .btn.primary {
            background: linear-gradient(90deg, #0ea5a4, #60a5fa);
            color: #001
        }

        .btn.ghost {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.03);
            color: var(--muted)
        }
        .form-row {
            display: flex;
            gap: 12px
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.03);
            background: var(--glass-2);
            color: inherit
        }

        label {
            display: block;
            font-size: 13px;
            color: var(--muted);
            margin-bottom: 6px
        }

        /* Responsive */
        @media(max-width:900px) {
            .grid {
                grid-template-columns: repeat(1, 1fr)
            }

            .sidebar {
                display: none
            }

            .app {
                flex-direction: column
            }

            .main {
                padding: 16px
            }
        }

        .small {
            font-size: 12px;
            color: var(--muted)
        }

        .category-tag {
            padding: 6px 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.02);
            font-size: 13px
        }

        .chart-wrap {
            display: flex;
            gap: 16px;
            align-items: center
        }

        .chart {
            width: 260px;
            height: 260px
        }

        footer {
            margin-top: 18px;
            color: var(--muted);
            font-size: 13px
        }
    </style>
</head>

<body>
    <div class="app">
        <aside class="sidebar">
            <div class="brand">ArthSaar</div>
            <div class="muted">Personal Finance Tracker</div>
            <nav class="nav" aria-label="Main Navigation">
                <button class="nav-btn active" data-page="dashboard">Dashboard</button>
                <button class="nav-btn" data-page="transactions">Transactions</button>
                <button class="nav-btn" data-page="add">Add Transaction</button>
                <button class="nav-btn" data-page="reports">Reports</button>
                <button class="nav-btn" data-page="settings">Settings</button>
            </nav>
            <div style="margin-top:18px">
                <div class="small">Tip</div>
                <div class="muted small">Add recurring savings by using the "Add Transaction" page and select tag
                    'Savings'.</div>
            </div>
        </aside>

        <main class="main">
            <div class="topbar">
                <div>
                    <h2 style="margin:0">Dashboard</h2>
                    <div class="small muted">Overview of your finances</div>
                </div>
                <div style="display:flex;gap:8px;align-items:center">
                    <input id="globalSearch" class="search" placeholder="Search transactions or categories..." />
                    <button id="exportBtn" class="btn ghost">Export CSV</button>
                </div>
            </div>
            <section id="dashboard" class="page">
                <div class="grid">
                    <div class="card">
                        <div class="muted">Balance</div>
                        <div class="big" id="balance">₹0</div>
                        <div class="muted small">Income - Expenses</div>
                    </div>
                    <div class="card">
                        <div class="muted">Income (30 days)</div>
                        <div class="big" id="income">₹0</div>
                        <div class="muted small">Total received</div>
                    </div>
                    <div class="card">
                        <div class="muted">Expense (30 days)</div>
                        <div class="big" id="expense">₹0</div>
                        <div class="muted small">Total spent</div>
                    </div>
                </div>

                <div style="display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap">
                    <div class="card" style="flex:1;min-width:320px">
                        <div class="muted">Recent Transactions</div>
                        <table class="table" id="recentTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Title</th>
                                    <th>Category</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <div class="card" style="width:320px">
                        <div class="muted">Spending by Category</div>
                        <div class="chart-wrap">
                            <canvas id="pieChart" class="chart" width="260" height="260"></canvas>
                        </div>
                        <div id="catList" style="margin-top:10px"></div>
                    </div>
                </div>
            </section>

            <section id="transactions" class="page" style="display:none">
                <div class="card"
                    style="margin-bottom:12px;display:flex;justify-content:space-between;align-items:center">
                    <div>
                        <div class="muted">All Transactions</div>
                        <div class="small muted">Manage and edit your transactions</div>
                    </div>
                    <div style="display:flex;gap:8px;align-items:center">
                        <select id="filterCategory">
                            <option value="">All categories</option>
                        </select>
                        <select id="filterType">
                            <option value="all">All</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <table class="table" id="txTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Title</th>
                                <th>Category</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <section id="add" class="page" style="display:none">
                <div class="card">
                    <div class="muted">Add New Transaction</div>
                    <form id="txForm" style="margin-top:12px">
                        <div class="form-row">
                            <div style="flex:1">
                                <label for="title">Title</label>
                                <input id="title" required />
                            </div>
                            <div style="width:150px">
                                <label for="date">Date</label>
                                <input id="date" type="date" required />
                            </div>
                        </div>

                        <div class="form-row" style="margin-top:10px">
                            <div style="flex:1">
                                <label for="amount">Amount (₹)</label>
                                <input id="amount" type="number" step="0.01" required />
                            </div>
                            <div style="width:160px">
                                <label for="type">Type</label>
                                <select id="type">
                                    <option value="expense">Expense</option>
                                    <option value="income">Income</option>
                                </select>
                            </div>
                        </div>

                        <div style="margin-top:10px">
                            <label for="category">Category (optional)</label>
                            <input id="category" placeholder="e.g., Food, Rent, Salary" />
                            <div class="muted small" style="margin-top:6px">If left blank, the app will auto-suggest
                                based on the title.</div>
                        </div>

                        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
                            <button type="submit" class="btn primary">Save</button>
                            <button type="button" id="clearForm" class="btn ghost">Clear</button>
                        </div>
                    </form>
                </div>
            </section>

            <section id="reports" class="page" style="display:none">
                <div class="card">
                    <div class="muted">Reports</div>
                    <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:12px">
                        <div style="flex:1;min-width:240px">
                            <div class="muted small">Monthly Summary</div>
                            <div id="monthlyList"></div>
                        </div>
                        <div style="width:320px">
                            <div class="muted small">Top Spending Categories</div>
                            <div id="topCats"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="settings" class="page" style="display:none">
                <div class="card">
                    <div class="muted">Settings</div>
                    <div style="margin-top:12px">
                        <label for="currency">Currency</label>
                        <select id="currency">
                            <option>INR (₹)</option>
                            <option>USD ($)</option>
                        </select>
                        <div style="margin-top:12px">
                            <label for="startupView">Startup Page</label>
                            <select id="startupView">
                                <option value="dashboard">Dashboard</option>
                                <option value="transactions">Transactions</option>
                            </select>
                        </div>
                        <div style="margin-top:12px">
                            <button id="resetBtn" class="btn ghost">Reset Data</button>
                        </div>
                    </div>
                </div>
            </section>

            <footer>Built with focus on clarity. Data stored locally in your browser (localStorage).</footer>
        </main>
    </div>

    <script>
        const CATEGORY_KEYWORDS = {
            Food: ['dinner', 'lunch', 'breakfast', 'cafe', 'restaurant', 'uber eats', 'zomato', 'swiggy', 'meal', 'pizza', 'burger'],
            Rent: ['rent', 'flat', 'apartment', 'pg'],
            Salary: ['salary', 'pay', 'ctc', 'payslip', 'salary credit'],
            Groceries: ['grocery', 'supermarket', 'bigbasket', 'dmart'],
            Transport: ['uber', 'ola', 'taxi', 'bus', 'train', 'metro', 'fuel'],
            Entertainment: ['netflix', 'prime', 'movie', 'cinema', 'spotify'],
            Bills: ['electric', 'water', 'bill', 'internet', 'broadband', 'phone'],
            Savings: ['save', 'savings', 'sip']
        };
        const qs = sel => document.querySelector(sel);
        const qsa = sel => document.querySelectorAll(sel);
        const navButtons = qsa('.nav-btn');
        const pages = qsa('.page');

        let transactions = JSON.parse(localStorage.getItem('txs') || '[]');
        let settings = JSON.parse(localStorage.getItem('fts_settings') || '{}');

        function saveAll() { localStorage.setItem('txs', JSON.stringify(transactions)); localStorage.setItem('fts_settings', JSON.stringify(settings)); }
        navButtons.forEach(btn => btn.addEventListener('click', e => {
            navButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const page = btn.dataset.page;
            showPage(page);
        }));

        function showPage(name) {
            pages.forEach(p => p.style.display = p.id === name ? '' : 'none');
            if (name === 'dashboard') renderDashboard();
            if (name === 'transactions') renderTransactions();
            if (name === 'reports') renderReports();
            if (name === 'add') { document.getElementById('txForm').reset(); }
        }
        function detectCategory(title) {
            const t = title.toLowerCase();
            for (const [cat, keys] of Object.entries(CATEGORY_KEYWORDS)) {
                for (const k of keys) if (t.includes(k)) return cat;
            }
            return 'Other';
        }
        const txForm = qs('#txForm');
        txForm.addEventListener('submit', e => {
            e.preventDefault();
            const title = qs('#title').value.trim();
            const date = qs('#date').value || new Date().toISOString().slice(0, 10);
            const amount = parseFloat(qs('#amount').value) || 0;
            const type = qs('#type').value;
            let category = qs('#category').value.trim();
            if (!category) category = detectCategory(title);
            const tx = { id: Date.now(), title, date, amount, type, category };
            transactions.unshift(tx);
            saveAll();
            alert('Saved');
            showPage('dashboard');
        });
        qs('#clearForm').addEventListener('click', () => txForm.reset());
        function renderDashboard() {
            const last30 = transactions.filter(tx => {
                const days = (new Date() - new Date(tx.date)) / (1000 * 60 * 60 * 24);
                return days <= 30;
            });
            const income = last30.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0);
            const expense = last30.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0);
            const balance = income - expense;
            qs('#income').textContent = '₹' + income.toFixed(2);
            qs('#expense').textContent = '₹' + expense.toFixed(2);
            qs('#balance').textContent = '₹' + balance.toFixed(2);

            const tbody = qs('#recentTable tbody'); tbody.innerHTML = '';
            transactions.slice(0, 8).forEach(tx => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${tx.date}</td><td>${tx.title}</td><td><span class="category-tag">${tx.category}</span></td><td>${tx.type === 'expense' ? '-' : ''}₹${tx.amount.toFixed(2)}</td>`;
                tbody.appendChild(tr);
            });

            renderPieChart();
        }
        function renderPieChart() {
            const canvas = qs('#pieChart'); const ctx = canvas.getContext('2d'); ctx.clearRect(0, 0, canvas.width, canvas.height);
            const expenses = transactions.filter(t => t.type === 'expense');
            const byCat = {};
            expenses.forEach(e => byCat[e.category] = (byCat[e.category] || 0) + e.amount);
            const entries = Object.entries(byCat).sort((a, b) => b[1] - a[1]);
            const total = entries.reduce((s, e) => s + e[1], 0);
            let start = 0; let i = 0; const colors = ['#60a5fa', '#f472b6', '#f59e0b', '#34d399', '#a78bfa', '#fb7185', '#f97316', '#60a5fa'];
            entries.forEach(([cat, amt]) => {
                const slice = (amt / total) * Math.PI * 2;
                ctx.beginPath(); ctx.moveTo(130, 130); ctx.arc(130, 130, 100, start, start + slice); ctx.closePath();
                ctx.fillStyle = colors[i % colors.length]; ctx.fill();
                start += slice; i++;
            });
            const list = qs('#catList'); list.innerHTML = '';
            entries.slice(0, 6).forEach(([cat, amt], idx) => {
                const el = document.createElement('div'); el.className = 'small'; el.style.display = 'flex'; el.style.justifyContent = 'space-between'; el.style.marginTop = '6px';
                el.innerHTML = `<div><span style="display:inline-block;width:12px;height:12px;background:${colors[idx % colors.length]};margin-right:8px;border-radius:3px"></span>${cat}</div><div>₹${amt.toFixed(2)}</div>`;
                list.appendChild(el);
            });
            if (entries.length === 0) { ctx.fillStyle = 'rgba(255,255,255,0.03)'; ctx.fillRect(0, 0, canvas.width, canvas.height); list.innerHTML = '<div class="muted small">No expense data yet</div>'; }
        }
        function renderTransactions() {
            const tbody = qs('#txTable tbody'); tbody.innerHTML = '';
            const filterCat = qs('#filterCategory').value;
            const filterType = qs('#filterType').value;
            const data = transactions.filter(t => (filterCat ? t.category === filterCat : true) && (filterType === 'all' ? true : t.type === filterType));
            data.forEach(tx => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${tx.date}</td><td>${tx.title}</td><td>${tx.category}</td><td>${tx.type}</td><td>₹${tx.amount.toFixed(2)}</td><td><button class='btn ghost' data-id='${tx.id}' data-action='edit'>Edit</button> <button class='btn' data-id='${tx.id}' data-action='del' style='background:${'--'}'>Delete</button></td>`;
                tbody.appendChild(tr);
            });
            tbody.querySelectorAll('button').forEach(b => b.addEventListener('click', e => {
                const id = Number(b.dataset.id); const action = b.dataset.action;
                if (action === 'del') { if (confirm('Delete transaction?')) { transactions = transactions.filter(t => t.id !== id); saveAll(); renderTransactions(); renderDashboard(); } }
                if (action === 'edit') {
                    const tx = transactions.find(t => t.id === id); if (tx) {
                        showPage('add'); qs('#title').value = tx.title; qs('#date').value = tx.date; qs('#amount').value = tx.amount; qs('#type').value = tx.type; qs('#category').value = tx.category; // delete old
                        transactions = transactions.filter(t => t.id !== id); saveAll();
                    }
                }
            }));
            const catSel = qs('#filterCategory'); const cats = Array.from(new Set(transactions.map(t => t.category))).sort();
            catSel.innerHTML = '<option value="">All categories</option>' + cats.map(c => `<option value="${c}">${c}</option>`).join('');
        }

        qs('#filterCategory').addEventListener('change', renderTransactions);
        qs('#filterType').addEventListener('change', renderTransactions);
        function renderReports() {
            const monthMap = {};
            transactions.forEach(t => {
                const m = t.date.slice(0, 7);
                monthMap[m] = monthMap[m] || { income: 0, expense: 0 };
                if (t.type === 'income') monthMap[m].income += t.amount; else monthMap[m].expense += t.amount;
            });
            const monthlyList = qs('#monthlyList'); monthlyList.innerHTML = Object.keys(monthMap).sort().reverse().slice(0, 6).map(m => {
                const val = monthMap[m]; return `<div style="padding:8px 6px;border-bottom:1px solid rgba(255,255,255,0.02)"><strong>${m}</strong> — Income: ₹${val.income.toFixed(2)} | Expense: ₹${val.expense.toFixed(2)}</div>`;
            }).join('') || '<div class="muted small">No data</div>';

            const byCat = {};
            transactions.filter(t => t.type === 'expense').forEach(t => byCat[t.category] = (byCat[t.category] || 0) + t.amount);
            const top = Object.entries(byCat).sort((a, b) => b[1] - a[1]).slice(0, 6);
            qs('#topCats').innerHTML = top.map(t => `<div class='small' style='padding:6px 0'>${t[0]} — ₹${t[1].toFixed(2)}</div>`).join('') || '<div class="muted small">No expense data</div>';
        }
        qs('#globalSearch').addEventListener('input', e => {
            const q = e.target.value.toLowerCase();
            const filtered = transactions.filter(t => t.title.toLowerCase().includes(q) || t.category.toLowerCase().includes(q));

            const tbody = qs('#recentTable tbody'); tbody.innerHTML = '';
            filtered.slice(0, 8).forEach(tx => { const tr = document.createElement('tr'); tr.innerHTML = `<td>${tx.date}</td><td>${tx.title}</td><td><span class='category-tag'>${tx.category}</span></td><td>₹${tx.amount.toFixed(2)}</td>`; tbody.appendChild(tr); });
        });

        qs('#exportBtn').addEventListener('click', () => {
            if (transactions.length === 0) { alert('No data'); return; }
            const csv = ['Date,Title,Category,Type,Amount', ...transactions.map(t => `${t.date},"${t.title.replace(/"/g, '""')}",${t.category},${t.type},${t.amount}`)].join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'transactions.csv'; a.click(); URL.revokeObjectURL(url);
        });


        qs('#resetBtn').addEventListener('click', () => { if (confirm('Clear all data?')) { transactions = []; saveAll(); renderDashboard(); renderTransactions(); } });
        (function init() {
            if (!settings.startup) settings.startup = 'dashboard';
            if (transactions.length === 0) {
                transactions = [
                    { id: 1, title: 'Salary Credit', date: new Date().toISOString().slice(0, 10), amount: 50000, type: 'income', category: 'Salary' },
                    { id: 2, title: 'Grocery Store', date: new Date().toISOString().slice(0, 10), amount: 2300, type: 'expense', category: 'Groceries' },
                    { id: 3, title: 'Rent Payment', date: new Date().toISOString().slice(0, 10), amount: 12000, type: 'expense', category: 'Rent' },
                ];
                saveAll();
            }
            showPage(settings.startup || 'dashboard');
        })();
    </script>
</body>

</html>